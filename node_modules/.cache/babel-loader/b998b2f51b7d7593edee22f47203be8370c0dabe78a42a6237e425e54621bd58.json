{"ast":null,"code":"import _objectSpread from\"C:/Users/javie/joker-dad/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _regeneratorRuntime from\"C:/Users/javie/joker-dad/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _toConsumableArray from\"C:/Users/javie/joker-dad/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _asyncToGenerator from\"C:/Users/javie/joker-dad/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _classCallCheck from\"C:/Users/javie/joker-dad/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";import _createClass from\"C:/Users/javie/joker-dad/node_modules/@babel/runtime/helpers/esm/createClass.js\";import _assertThisInitialized from\"C:/Users/javie/joker-dad/node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js\";import _inherits from\"C:/Users/javie/joker-dad/node_modules/@babel/runtime/helpers/esm/inherits.js\";import _createSuper from\"C:/Users/javie/joker-dad/node_modules/@babel/runtime/helpers/esm/createSuper.js\";import React,{Component}from\"react\";import Joke from\"./Joke\";import axios from\"axios\";import uuid from\"uuid/v4\";import\"./JokeList.css\";var JokeList=/*#__PURE__*/function(_Component){_inherits(JokeList,_Component);var _super=_createSuper(JokeList);function JokeList(props){var _this;_classCallCheck(this,JokeList);_this=_super.call(this,props);_this.state={jokes:JSON.parse(window.localStorage.getItem(\"jokes\")||\"[]\"),loading:false};_this.seenJokes=new Set(_this.state.jokes.map(function(j){return j.text;}));console.log(_this.seenJokes);_this.handleClick=_this.handleClick.bind(_assertThisInitialized(_this));return _this;}_createClass(JokeList,[{key:\"componentDidMount\",value:function componentDidMount(){if(this.state.jokes.length===0)this.getJokes();}},{key:\"getJokes\",value:function(){var _getJokes=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var _this2=this;var jokes,res,newJoke;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;jokes=[];case 2:if(!(jokes.length<this.props.numJokesToGet)){_context.next=10;break;}_context.next=5;return axios.get(\"https://icanhazdadjoke.com/\",{headers:{Accept:\"application/json\"}});case 5:res=_context.sent;newJoke=res.data.joke;if(!this.seenJokes.has(newJoke)){jokes.push({id:uuid(),text:newJoke,votes:0});}else{console.log(\"FOUND A DUPLICATE!\");console.log(newJoke);}_context.next=2;break;case 10:this.setState(function(st){return{loading:false,jokes:[].concat(_toConsumableArray(st.jokes),jokes)};},function(){return window.localStorage.setItem(\"jokes\",JSON.stringify(_this2.state.jokes));});_context.next=17;break;case 13:_context.prev=13;_context.t0=_context[\"catch\"](0);alert(_context.t0);this.setState({loading:false});case 17:case\"end\":return _context.stop();}}},_callee,this,[[0,13]]);}));function getJokes(){return _getJokes.apply(this,arguments);}return getJokes;}()},{key:\"handleVote\",value:function handleVote(id,delta){var _this3=this;this.setState(function(st){return{jokes:st.jokes.map(function(j){return j.id===id?_objectSpread(_objectSpread({},j),{},{votes:j.votes+delta}):j;})};},function(){return window.localStorage.setItem(\"jokes\",JSON.stringify(_this3.state.jokes));});}},{key:\"handleClick\",value:function handleClick(){this.setState({loading:true},this.getJokes);}},{key:\"render\",value:function render(){var _this4=this;if(this.state.loading){return/*#__PURE__*/React.createElement(\"div\",{className:\"JokeList-spinner\"},/*#__PURE__*/React.createElement(\"i\",{className:\"far fa-8x fa-laugh fa-spin\"}),/*#__PURE__*/React.createElement(\"h1\",{className:\"JokeList-title\"},\"Loading...\"));}var jokes=this.state.jokes.sort(function(a,b){return b.votes-a.votes;});return/*#__PURE__*/React.createElement(\"div\",{className:\"JokeList\"},/*#__PURE__*/React.createElement(\"div\",{className:\"JokeList-sidebar\"},/*#__PURE__*/React.createElement(\"h1\",{className:\"JokeList-title\"},/*#__PURE__*/React.createElement(\"span\",null,\"Dad\"),\" Jokes\"),/*#__PURE__*/React.createElement(\"img\",{src:\"https://assets.dryicons.com/uploads/icon/svg/8927/0eb14c71-38f2-433a-bfc8-23d9c99b3647.svg\"}),/*#__PURE__*/React.createElement(\"button\",{className:\"JokeList-getmore\",onClick:this.handleClick},\"Fetch Jokes\")),/*#__PURE__*/React.createElement(\"div\",{className:\"JokeList-jokes\"},jokes.map(function(j){return/*#__PURE__*/React.createElement(Joke,{key:j.id,votes:j.votes,text:j.text,upvote:function upvote(){return _this4.handleVote(j.id,1);},downvote:function downvote(){return _this4.handleVote(j.id,-1);}});})));}}]);return JokeList;}(Component);JokeList.defaultProps={numJokesToGet:10};export default JokeList;","map":{"version":3,"names":["React","Component","Joke","axios","uuid","JokeList","props","state","jokes","JSON","parse","window","localStorage","getItem","loading","seenJokes","Set","map","j","text","console","log","handleClick","bind","length","getJokes","numJokesToGet","get","headers","Accept","res","newJoke","data","joke","has","push","id","votes","setState","st","setItem","stringify","alert","delta","sort","a","b","handleVote","defaultProps"],"sources":["C:/Users/javie/joker-dad/src/JokeList.js"],"sourcesContent":["import React, { Component } from \"react\";\r\nimport Joke from \"./Joke\";\r\nimport axios from \"axios\";\r\nimport uuid from \"uuid/v4\";\r\nimport \"./JokeList.css\";\r\n\r\nclass JokeList extends Component {\r\n  static defaultProps = {\r\n    numJokesToGet: 10\r\n  };\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      jokes: JSON.parse(window.localStorage.getItem(\"jokes\") || \"[]\"),\r\n      loading: false\r\n    };\r\n    this.seenJokes = new Set(this.state.jokes.map(j => j.text));\r\n    console.log(this.seenJokes);\r\n    this.handleClick = this.handleClick.bind(this);\r\n  }\r\n  componentDidMount() {\r\n    if (this.state.jokes.length === 0) this.getJokes();\r\n  }\r\n  async getJokes() {\r\n    try {\r\n      let jokes = [];\r\n      while (jokes.length < this.props.numJokesToGet) {\r\n        let res = await axios.get(\"https://icanhazdadjoke.com/\", {\r\n          headers: { Accept: \"application/json\" }\r\n        });\r\n        let newJoke = res.data.joke;\r\n        if (!this.seenJokes.has(newJoke)) {\r\n          jokes.push({ id: uuid(), text: newJoke, votes: 0 });\r\n        } else {\r\n          console.log(\"FOUND A DUPLICATE!\");\r\n          console.log(newJoke);\r\n        }\r\n      }\r\n      this.setState(\r\n        st => ({\r\n          loading: false,\r\n          jokes: [...st.jokes, ...jokes]\r\n        }),\r\n        () =>\r\n          window.localStorage.setItem(\"jokes\", JSON.stringify(this.state.jokes))\r\n      );\r\n    } catch (e) {\r\n      alert(e);\r\n      this.setState({ loading: false });\r\n    }\r\n  }\r\n  handleVote(id, delta) {\r\n    this.setState(\r\n      st => ({\r\n        jokes: st.jokes.map(j =>\r\n          j.id === id ? { ...j, votes: j.votes + delta } : j\r\n        )\r\n      }),\r\n      () =>\r\n        window.localStorage.setItem(\"jokes\", JSON.stringify(this.state.jokes))\r\n    );\r\n  }\r\n  handleClick() {\r\n    this.setState({ loading: true }, this.getJokes);\r\n  }\r\n  render() {\r\n    if (this.state.loading) {\r\n      return (\r\n        <div className='JokeList-spinner'>\r\n          <i className='far fa-8x fa-laugh fa-spin' />\r\n          <h1 className='JokeList-title'>Loading...</h1>\r\n        </div>\r\n      );\r\n    }\r\n    let jokes = this.state.jokes.sort((a, b) => b.votes - a.votes);\r\n    return (\r\n      <div className='JokeList'>\r\n        <div className='JokeList-sidebar'>\r\n          <h1 className='JokeList-title'>\r\n            <span>Dad</span> Jokes\r\n          </h1>\r\n          <img src='https://assets.dryicons.com/uploads/icon/svg/8927/0eb14c71-38f2-433a-bfc8-23d9c99b3647.svg' />\r\n          <button className='JokeList-getmore' onClick={this.handleClick}>\r\n            Fetch Jokes\r\n          </button>\r\n        </div>\r\n\r\n        <div className='JokeList-jokes'>\r\n          {jokes.map(j => (\r\n            <Joke\r\n              key={j.id}\r\n              votes={j.votes}\r\n              text={j.text}\r\n              upvote={() => this.handleVote(j.id, 1)}\r\n              downvote={() => this.handleVote(j.id, -1)}\r\n            />\r\n          ))}\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\nexport default JokeList;\r\n"],"mappings":"q/BAAA,MAAOA,MAAK,EAAIC,SAAS,KAAQ,OAAO,CACxC,MAAOC,KAAI,KAAM,QAAQ,CACzB,MAAOC,MAAK,KAAM,OAAO,CACzB,MAAOC,KAAI,KAAM,SAAS,CAC1B,MAAO,gBAAgB,CAAC,GAElBC,SAAQ,oGAIZ,kBAAYC,KAAK,CAAE,0CACjB,uBAAMA,KAAK,EACX,MAAKC,KAAK,CAAG,CACXC,KAAK,CAAEC,IAAI,CAACC,KAAK,CAACC,MAAM,CAACC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC,EAAI,IAAI,CAAC,CAC/DC,OAAO,CAAE,KACX,CAAC,CACD,MAAKC,SAAS,CAAG,GAAIC,IAAG,CAAC,MAAKT,KAAK,CAACC,KAAK,CAACS,GAAG,CAAC,SAAAC,CAAC,QAAIA,EAAC,CAACC,IAAI,GAAC,CAAC,CAC3DC,OAAO,CAACC,GAAG,CAAC,MAAKN,SAAS,CAAC,CAC3B,MAAKO,WAAW,CAAG,MAAKA,WAAW,CAACC,IAAI,+BAAM,CAAC,aACjD,CAAC,sDACD,4BAAoB,CAClB,GAAI,IAAI,CAAChB,KAAK,CAACC,KAAK,CAACgB,MAAM,GAAK,CAAC,CAAE,IAAI,CAACC,QAAQ,EAAE,CACpD,CAAC,2GACD,2LAEQjB,KAAK,CAAG,EAAE,aACPA,KAAK,CAACgB,MAAM,CAAG,IAAI,CAAClB,KAAK,CAACoB,aAAa,iDAC5BvB,MAAK,CAACwB,GAAG,CAAC,6BAA6B,CAAE,CACvDC,OAAO,CAAE,CAAEC,MAAM,CAAE,kBAAmB,CACxC,CAAC,CAAC,QAFEC,GAAG,eAGHC,OAAO,CAAGD,GAAG,CAACE,IAAI,CAACC,IAAI,CAC3B,GAAI,CAAC,IAAI,CAAClB,SAAS,CAACmB,GAAG,CAACH,OAAO,CAAC,CAAE,CAChCvB,KAAK,CAAC2B,IAAI,CAAC,CAAEC,EAAE,CAAEhC,IAAI,EAAE,CAAEe,IAAI,CAAEY,OAAO,CAAEM,KAAK,CAAE,CAAE,CAAC,CAAC,CACrD,CAAC,IAAM,CACLjB,OAAO,CAACC,GAAG,CAAC,oBAAoB,CAAC,CACjCD,OAAO,CAACC,GAAG,CAACU,OAAO,CAAC,CACtB,CAAC,8BAEH,IAAI,CAACO,QAAQ,CACX,SAAAC,EAAE,QAAK,CACLzB,OAAO,CAAE,KAAK,CACdN,KAAK,8BAAM+B,EAAE,CAAC/B,KAAK,EAAKA,KAAK,CAC/B,CAAC,EAAC,CACF,iBACEG,OAAM,CAACC,YAAY,CAAC4B,OAAO,CAAC,OAAO,CAAE/B,IAAI,CAACgC,SAAS,CAAC,MAAI,CAAClC,KAAK,CAACC,KAAK,CAAC,CAAC,GACzE,CAAC,iFAEFkC,KAAK,aAAG,CACR,IAAI,CAACJ,QAAQ,CAAC,CAAExB,OAAO,CAAE,KAAM,CAAC,CAAC,CAAC,qEAErC,4GACD,oBAAWsB,EAAE,CAAEO,KAAK,CAAE,iBACpB,IAAI,CAACL,QAAQ,CACX,SAAAC,EAAE,QAAK,CACL/B,KAAK,CAAE+B,EAAE,CAAC/B,KAAK,CAACS,GAAG,CAAC,SAAAC,CAAC,QACnBA,EAAC,CAACkB,EAAE,GAAKA,EAAE,gCAAQlB,CAAC,MAAEmB,KAAK,CAAEnB,CAAC,CAACmB,KAAK,CAAGM,KAAK,GAAKzB,CAAC,GAEtD,CAAC,EAAC,CACF,iBACEP,OAAM,CAACC,YAAY,CAAC4B,OAAO,CAAC,OAAO,CAAE/B,IAAI,CAACgC,SAAS,CAAC,MAAI,CAAClC,KAAK,CAACC,KAAK,CAAC,CAAC,GACzE,CACH,CAAC,2BACD,sBAAc,CACZ,IAAI,CAAC8B,QAAQ,CAAC,CAAExB,OAAO,CAAE,IAAK,CAAC,CAAE,IAAI,CAACW,QAAQ,CAAC,CACjD,CAAC,sBACD,iBAAS,iBACP,GAAI,IAAI,CAAClB,KAAK,CAACO,OAAO,CAAE,CACtB,mBACE,2BAAK,SAAS,CAAC,kBAAkB,eAC/B,yBAAG,SAAS,CAAC,4BAA4B,EAAG,cAC5C,0BAAI,SAAS,CAAC,gBAAgB,eAAgB,CAC1C,CAEV,CACA,GAAIN,MAAK,CAAG,IAAI,CAACD,KAAK,CAACC,KAAK,CAACoC,IAAI,CAAC,SAACC,CAAC,CAAEC,CAAC,QAAKA,EAAC,CAACT,KAAK,CAAGQ,CAAC,CAACR,KAAK,GAAC,CAC9D,mBACE,2BAAK,SAAS,CAAC,UAAU,eACvB,2BAAK,SAAS,CAAC,kBAAkB,eAC/B,0BAAI,SAAS,CAAC,gBAAgB,eAC5B,sCAAgB,UACb,cACL,2BAAK,GAAG,CAAC,4FAA4F,EAAG,cACxG,8BAAQ,SAAS,CAAC,kBAAkB,CAAC,OAAO,CAAE,IAAI,CAACf,WAAY,gBAEtD,CACL,cAEN,2BAAK,SAAS,CAAC,gBAAgB,EAC5Bd,KAAK,CAACS,GAAG,CAAC,SAAAC,CAAC,qBACV,oBAAC,IAAI,EACH,GAAG,CAAEA,CAAC,CAACkB,EAAG,CACV,KAAK,CAAElB,CAAC,CAACmB,KAAM,CACf,IAAI,CAAEnB,CAAC,CAACC,IAAK,CACb,MAAM,CAAE,wBAAM,OAAI,CAAC4B,UAAU,CAAC7B,CAAC,CAACkB,EAAE,CAAE,CAAC,CAAC,EAAC,CACvC,QAAQ,CAAE,0BAAM,OAAI,CAACW,UAAU,CAAC7B,CAAC,CAACkB,EAAE,CAAE,CAAC,CAAC,CAAC,EAAC,EAC1C,EACH,CAAC,CACE,CACF,CAEV,CAAC,sBA9FoBnC,SAAS,EAA1BI,QAAQ,CACL2C,YAAY,CAAG,CACpBtB,aAAa,CAAE,EACjB,CAAC,CA6FH,cAAerB,SAAQ"},"metadata":{},"sourceType":"module","externalDependencies":[]}